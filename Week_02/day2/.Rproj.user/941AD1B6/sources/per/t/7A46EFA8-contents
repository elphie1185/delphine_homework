```{r}
library(keyring)
keyring_unlock(keyring = "local")
username <- key_get("postgresql_username", keyring = "local")
password <- key_get("postgresql_password", keyring = "local")
keyring_lock("local")
```

Connect to the database
```{r}
library(RPostgreSQL)
my_db_connection <- dbConnect(drv = PostgreSQL(max.con = 2), 
                              user = username, 
                              password = password, 
                              dbname='wrestling', 
                              host='localhost')
```
  
Select everything from the table wrestlers  
```{r}
dbGetQuery(conn = my_db_connection, 
           "SELECT * FROM wrestlers")
```

Type of data
Id: Primary call
Born: character
Name: character
Gender: character
win_percent: integer
total_matches: integer

Return all the details for any wrestlers from the United Kingdom
```{r}
dbGetQuery(conn = my_db_connection, 
           statement = "SELECT * FROM wrestlers WHERE born = 'United Kingdom'")
```


Get the names of all Japanese wrestlers who have appeared in 40 or more matches.
```{r}
dbGetQuery(conn = my_db_connection, 
           statement = "SELECT * 
           FROM wrestlers 
           WHERE born = 'Japan' AND total_matches >= 40")
```


Find the wrestlers who have won between 50% and 60% of their matches.
```{r}
dbGetQuery(conn = my_db_connection, 
           statement = "SELECT * FROM wrestlers 
           WHERE win_percent BETWEEN 50 AND 60")
```


Find all the wrestlers with names beginning with ‘X’.
```{r}
dbGetQuery(conn = my_db_connection, 
           statement = "SELECT * FROM wrestlers
           WHERE name LIKE 'X%'")
```


Find all the wrestlers who were born in countries beginning with the letter ‘I’. Try this using IN (there are 9 countries) and using a wildcard comparison.
```{r}
dbGetQuery(conn = my_db_connection, 
           statement = "SELECT * FROM wrestlers
           WHERE (born IN ('Mexico', 'USA', 'United Kingdom', 'Finland', 'Argentina', 'New Zealand', 'Australia', 'Canada', 'Italy', 'Russia)) AND (born LIKE 'I%')")
```


Find all the wrestlers who were not born in countries beginning with the letter ‘I’.

```{r}
dbGetQuery(conn = my_db_connection, 
           statement = "SELECT * FROM wrestlers
           WHERE born NOT LIKE 'I%'")
```



```{r}
dbDisconnect(conn = my_db_connection)
```

